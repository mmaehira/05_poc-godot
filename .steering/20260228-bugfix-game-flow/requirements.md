# Requirements: ゲームフロー バグ修正

## 概要
ゲームの基本フロー（開始→プレイ→終了→リトライ）に関する4つのバグを修正する。

---

## Bug 1: ステージクリア条件の追加
### 現状
- `MAX_GAME_TIME = 900秒`（15分）経過で `_on_time_limit_reached()` → 強制死亡
- 勝利条件（ステージクリア）が存在しない

### 要求
- 1分経過でステージクリアとする（本番では1ステージ3分を想定）
- ステージクリア時はゲームオーバーではなく「ステージクリア」として表示する
- クリア画面にもスタッツ（生存時間、キル数、レベル等）を表示する
- クリア画面から「リトライ」「タイトルへ」を選択できる

### 受け入れ条件
- [ ] 60秒経過でステージクリア画面が表示される
- [ ] クリア画面にゲーム統計が表示される
- [ ] クリア画面からリトライ・タイトルへ遷移できる
- [ ] クリア時にゲームが一時停止する

---

## Bug 2: ポーズメニューの実装
### 現状
- `GameManager`にpause/resume メソッドは存在するが、UIと入力が未実装
- Escapeキーのinput action未定義

### 要求
- ゲームプレイ中にEscapeキーでポーズメニューを表示
- ポーズメニューには「続ける」「タイトルに戻る」のボタンを配置
- ポーズ中はゲームが一時停止する

### 受け入れ条件
- [ ] Escapeキーでポーズメニューが開閉できる
- [ ] 「続ける」でゲームが再開する
- [ ] 「タイトルに戻る」でタイトル画面に遷移する
- [ ] ポーズ中は敵の移動・弾丸・タイマーがすべて停止する

---

## Bug 3: タイトル画面スキップの修正
### 現状
- `SKIP_TITLE_FOR_DEBUG = true` がハードコードされており、タイトル画面が常にスキップされる
- ゲーム起動時に即座に `_start_game()` が呼ばれる

### 要求
- デバッグフラグを `false` に変更し、タイトル画面を正常に表示する
- タイトル画面の「ゲーム開始」ボタンを押すまでゲームが開始されないことを保証する

### 受け入れ条件
- [ ] 起動時にタイトル画面が表示される
- [ ] 「ゲーム開始」を押すまで敵が出現しない
- [ ] タイトル画面表示中にプレイヤーが操作できない

---

## Bug 4: ゲーム状態リセットの修正
### 現状
リトライ/タイトルへ戻った後に以下がリセットされない:
- `WeaponManager.weapons` 配列（取得済み武器がすべて残る）
- `WeaponManager.critical_rate`、`area_multiplier`、`multishot_count`
- `Player.active_powerups` 辞書

### 要求
- リトライ時・タイトルへ戻る時に、すべてのゲーム状態を初期値にリセットする
- 初期武器（straight_shot Lv1）のみでゲームを開始する

### 受け入れ条件
- [ ] リトライ後、武器がstraight_shot Lv1のみになる
- [ ] リトライ後、critical_rate/area_multiplier/multishot_countが初期値になる
- [ ] リトライ後、active_powerupsが空になる
- [ ] タイトルへ戻った後の再開時も同様にリセットされる
