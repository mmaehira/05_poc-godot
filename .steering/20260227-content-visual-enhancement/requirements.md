# requirements.md
コンテンツ&ビジュアル強化フェーズの要求内容

---

## 作業概要

**作業名**: コンテンツ&ビジュアル強化（軽量版）
**作業期間**: 2026-02-27 〜
**目的**: ゲームプレイの多様性向上 + 視覚的完成度向上

---

## 実装範囲

### A. コンテンツ拡張（軽量版）

#### 1. 新しい武器3種類

##### 武器1: レーザービーム
- **攻撃タイプ**: 直線貫通
- **特徴**: 複数の敵を貫通してダメージ
- **威力**: 8（直線ショットより低いが貫通）
- **攻撃速度**: 0.6秒
- **射程**: 画面端まで
- **ビジュアル**: 赤い直線レーザー

##### 武器2: オービタル
- **攻撃タイプ**: 周囲回転
- **特徴**: プレイヤーの周囲を回る衛星が接触した敵にダメージ
- **威力**: 15
- **攻撃速度**: 継続（常時回転）
- **射程**: プレイヤーから半径80
- **ビジュアル**: 青い球体が回転

##### 武器3: ライトニング
- **攻撃タイプ**: 連鎖攻撃
- **特徴**: 最も近い敵に命中後、近くの敵に連鎖（最大3体）
- **威力**: 12（連鎖ごとに20%減衰）
- **攻撃速度**: 1.2秒
- **射程**: 200（連鎖範囲: 100）
- **ビジュアル**: 黄色い稲妻

#### 2. 新しい敵2種類

##### 敵1: タンク型（HeavyEnemy）
- **HP**: 150
- **速度**: 60
- **経験値**: 10
- **特徴**: 高HP、低速度、近接型
- **ビジュアル**: 大きい赤四角（48x48）
- **AI**: 追跡（BasicEnemyと同じ）

##### 敵2: スピード型（FastEnemy）
- **HP**: 15
- **速度**: 150
- **経験値**: 3
- **特徴**: 低HP、高速度、接近型
- **ビジュアル**: 小さい黄丸（16x16）
- **AI**: 追跡（BasicEnemyと同じ）

#### 3. 新しいアップグレード3種類

##### アップグレード1: クリティカル率UP
- **効果**: クリティカル率+10%（最大50%）
- **レアリティ**: Rare（25%）
- **表示名**: "Critical Strike"
- **説明**: "攻撃が10%の確率で2倍ダメージ"

##### アップグレード2: 範囲拡大
- **効果**: 範囲攻撃の範囲+20%
- **レアリティ**: Common（70%）
- **表示名**: "Area Expansion"
- **説明**: "範囲攻撃の効果範囲が拡大"

##### アップグレード3: 弾数増加
- **効果**: 発射弾数+1（最大5）
- **レアリティ**: Rare（25%）
- **表示名**: "Multishot"
- **説明**: "武器の発射弾数が増加"

---

### B. ビジュアル/オーディオ（軽量版）

#### 1. パーティクルエフェクト

##### エフェクト1: 攻撃時エフェクト
- **対象**: 弾丸発射時
- **内容**: 小さな火花パーティクル
- **色**: 武器ごとに変更（黄色、赤、青）
- **実装**: GPUParticles2D

##### エフェクト2: 敵撃破エフェクト
- **対象**: 敵のdie()時
- **内容**: 爆発パーティクル
- **色**: 赤〜オレンジのグラデーション
- **実装**: GPUParticles2D

##### エフェクト3: レベルアップエフェクト
- **対象**: プレイヤーレベルアップ時
- **内容**: 光の輪が広がる
- **色**: 金色
- **実装**: GPUParticles2D

##### エフェクト4: 経験値オーブの輝き
- **対象**: ExpOrb
- **内容**: 常時発光
- **色**: 緑〜黄のグラデーション
- **実装**: GPUParticles2D（小規模）

#### 2. サウンドエフェクト

##### SE1: 攻撃音
- **対象**: 武器発射時
- **形式**: .wav または .ogg
- **長さ**: 0.1-0.3秒
- **音量**: 中
- **ソース**: フリー素材 or 生成

##### SE2: ヒット音
- **対象**: 敵被弾時
- **形式**: .wav または .ogg
- **長さ**: 0.1秒
- **音量**: 小
- **ソース**: フリー素材 or 生成

##### SE3: 敵撃破音
- **対象**: 敵die()時
- **形式**: .wav または .ogg
- **長さ**: 0.3-0.5秒
- **音量**: 中
- **ソース**: フリー素材 or 生成

##### SE4: レベルアップ音
- **対象**: レベルアップ時
- **形式**: .wav または .ogg
- **長さ**: 1.0秒
- **音量**: 大
- **ソース**: フリー素材 or 生成

##### SE5: 経験値取得音
- **対象**: ExpOrb収集時
- **形式**: .wav または .ogg
- **長さ**: 0.2秒
- **音量**: 小
- **ソース**: フリー素材 or 生成

##### SE6: UI音
- **対象**: ボタンクリック、アップグレード選択
- **形式**: .wav または .ogg
- **長さ**: 0.1秒
- **音量**: 小
- **ソース**: フリー素材 or 生成

---

## 含まれない機能（スコープ外）

- BGM（音楽）
- 複雑なアニメーションシステム
- 追加の敵3種類以上
- 追加の武器4種類以上
- ボス戦
- 複数ステージ
- メタプログレッション

---

## 技術要件

### パーティクル
- **エンジン**: GPUParticles2D（Godot標準）
- **テクスチャ**: シンプルな円形・星形（プロシージャル生成可）
- **パフォーマンス**: 同時表示100個以下

### サウンド
- **フォーマット**: .ogg 推奨（.wavも可）
- **サンプルレート**: 44100Hz
- **ビットレート**: 128kbps
- **ソース**:
  - オプション1: フリー素材サイト（freesound.org等）
  - オプション2: jsfxr等のツールで生成
  - オプション3: Godot内でAudioStreamGeneratorを使用

### 武器システム拡張
- 既存のWeapon Resourceを拡張
- 新しいAttackTypeを追加（PENETRATING, ORBITAL, CHAIN）
- WeaponInstance.gdに対応する攻撃ロジック追加

### 敵システム拡張
- 既存のEnemy基底クラスを継承
- パラメータのみ変更（AI変更なし）

---

## 成功基準

### 機能面
- [ ] 新しい武器3種類が正常に動作する
- [ ] 新しい敵2種類が正常にスポーンする
- [ ] 新しいアップグレード3種類が正常に適用される
- [ ] パーティクルエフェクトが適切に表示される
- [ ] サウンドエフェクトが適切なタイミングで再生される

### パフォーマンス面
- [ ] FPS 30以上を維持（パーティクル追加後）
- [ ] サウンド再生時にラグが発生しない
- [ ] メモリ使用量512MB以下

### 品質面
- [ ] 全ての新機能に型アノテーションがある
- [ ] nullチェックが適切に実装されている
- [ ] DebugConfigを使用したログ出力
- [ ] コメント・ドキュメント完備

---

## 制約事項

### 技術的制約
- Godot 4.3の機能のみ使用
- 外部プラグイン不可
- 既存のアーキテクチャを維持

### スコープ制約
- 武器は3種類まで
- 敵は2種類まで
- サウンドはSEのみ（BGMなし）
- パーティクルはシンプルなものに限定

### 時間制約
- 2-3日で完成を目指す
- 各タスクは4時間以内

---

## リスク管理

### 高リスク
- **サウンド素材の調達**: フリー素材が見つからない可能性
  - 対策: jsfxr等のツールで自作

### 中リスク
- **新しい武器のバランス**: 強すぎる/弱すぎる可能性
  - 対策: パラメータを外部から調整可能にする

### 低リスク
- **パーティクル実装**: Godot標準機能で実装可能

---

## 次のステップ

1. design.mdで詳細設計を行う
2. tasklist.mdでタスク分解
3. 実装開始

---

**作成日**: 2026-02-27
**承認待ち**
